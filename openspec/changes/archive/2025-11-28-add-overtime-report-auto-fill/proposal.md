# 加班補報自動填寫功能

## Why

目前系統只能**查詢**加班時數,但無法自動填寫到 SSP 系統的「加班補報申請單」。使用者需要:

1. 在本程式查看計算好的加班時數
2. 手動開啟瀏覽器登入 SSP 系統
3. 逐筆手動填寫加班日期、內容、時數
4. 容易出錯且耗時

這個功能將自動化整個流程,從查詢到填寫一氣呵成,大幅提升效率。

## What Changes

### 核心功能
- ✅ **加班補報分頁**: 新增專用分頁,預設顯示加班補報介面
- ✅ **本月異常清單分頁**: 將現有報表移到獨立分頁
- ✅ **自動填寫表單**: 根據計算結果自動填入 SSP 加班補報表單
- ✅ **狀態檢查**: 自動查詢已申請記錄,避免重複申請
- ✅ **預覽模式**: 測試階段只填寫不送出,正式版本支援送出
- ✅ **手動編輯**: 每筆記錄可編輯加班內容
- ✅ **加班/調休選擇**: 每筆記錄可獨立選擇(預設加班)
- ✅ **錯誤處理**: 顯示已申請狀態,允許手動刪除多餘記錄

### 技術實現
- **新增服務**: `OvertimeReportService` 處理補報表單填寫
- **新增服務**: `OvertimeStatusService` 查詢已申請記錄
- **新增 UI 元件**: `OvertimeReportTab` 加班補報分頁
- **重構主視窗**: 使用 `CTkTabview` 實現分頁切換
- **ASP.NET 表單處理**: 
  - ViewState 管理
  - PostBack 觸發「增加列」
  - 多筆記錄填寫
  - 分頁資料抓取

### 使用者流程
1. 登入系統後自動顯示「加班補報」分頁
2. 查看待填寫的加班記錄列表
3. 編輯每筆記錄的加班內容
4. 選擇「加班」或「調休」(預設加班)
5. 勾選要申請的記錄(已申請的顯示狀態並禁用)
6. **測試階段**: 點擊「預覽填寫」檢查表單內容
7. **正式版本**: 點擊「送出申請」實際提交表單

## Impact

### 影響的程式碼
- ✅ **新增**: `src/services/overtime_report_service.py` - 補報表單填寫
- ✅ **新增**: `src/services/overtime_status_service.py` - 已申請記錄查詢
- ✅ **新增**: `ui/components/overtime_report_tab.py` - 加班補報 UI
- ✅ **新增**: `ui/components/attendance_tab.py` - 出勤異常清單 UI
- ✅ **修改**: `ui/main_window.py` - 重構為分頁式介面
- ✅ **修改**: `src/models/overtime_submission.py` - 新增補報資料模型

### 影響的功能規格
- **新增**: `overtime-report-submission` - 加班補報自動填寫
- **相依**: 現有的 `authentication` 和 `data-fetching` 功能

### 使用者影響
- ✅ **正面**: 自動化填寫,節省大量時間
- ✅ **正面**: 避免手動輸入錯誤
- ✅ **正面**: 分頁介面更清晰
- ⚠️ **注意**: UI 佈局變更(從單頁改為分頁)
- ⚠️ **注意**: 測試階段需先預覽確認

### 風險評估
- ⚠️ **中風險**: ASP.NET 表單結構變更需適配
- ⚠️ **中風險**: 重複申請檢查邏輯需嚴謹
- ⚠️ **低風險**: 新增功能不影響現有查詢功能
- ✅ **緩解措施**: 提供預覽模式,確認無誤再送出

## Deployment Strategy

### 階段 1: 預覽模式 (v1.2.0-beta)
- 實現所有功能但不實際送出表單
- 只顯示填寫預覽結果
- 收集使用者回饋

### 階段 2: 完整功能 (v1.2.0)
- 啟用送出功能
- 提供確認對話框
- 完整錯誤處理
